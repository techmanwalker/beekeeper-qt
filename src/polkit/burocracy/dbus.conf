<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-Bus Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- SELinux context association -->
  <selinux>
    <associate own="org.beekeeper.Helper" context="system_u:system_r:beekeeper_t:s0"/>
  </selinux>
  
  <policy user="root">
    <allow own="org.beekeeper.Helper"/>
    <allow send_destination="org.beekeeper.Helper"/>
    <allow receive_sender="org.beekeeper.Helper"/>
  </policy>

  <policy context="default">
    <allow send_destination="org.beekeeper.Helper"/>
    <allow send_interface="org.beekeeper.Helper"/>
    <allow receive_sender="org.beekeeper.Helper"/>
    <allow receive_interface="org.beekeeper.Helper"/>
  </policy>

  <!-- SELinux-specific policies -->
  <policy selinux="beekeeper_t">
    <allow own="org.beekeeper.Helper"/>
    <allow send_destination="*"/>
    <allow receive_sender="*"/>
  </policy>

  <policy selinux="unconfined_t">
    <allow send_destination="org.beekeeper.Helper"/>
    <allow receive_sender="org.beekeeper.Helper"/>
  </policy>
</busconfig>